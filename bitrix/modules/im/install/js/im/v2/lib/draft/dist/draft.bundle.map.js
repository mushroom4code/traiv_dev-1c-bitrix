{"version":3,"file":"draft.bundle.map.js","names":["this","BX","Messenger","v2","exports","main_core","main_core_events","im_v2_lib_logger","im_v2_application_core","ui_dexie","im_v2_lib_localStorage","im_v2_const","DB_NAME","recentDraftLocalStorageKey","copilotDraftLocalStorageKey","IndexedDbManager","static","instance","constructor","db","Dexie","version","stores","drafts","async","migrationStatus","get","recentDrafts","LocalStorageManager","getInstance","set","remove","copilotDrafts","setMigrationFinished","key","value","put","result","defaultValue","migrateFromLocalStorage","WRITE_TO_STORAGE_TIMEOUT","SHOW_DRAFT_IN_RECENT_TIMEOUT","STORAGE_KEY","DraftManager","inited","initPromise","Promise","resolve","initPromiseResolver","EventEmitter","subscribe","EventType","layout","onLayoutChange","bind","draftHistory","getStorageKey","error","console","fillDraftsFromStorage","Logger","warn","setRecentListDraftText","ready","Type","isPlainObject","Object","entries","forEach","dialogId","draft","setDraftText","text","trim","refreshSaveTimeout","setDraftPanel","panelType","messageId","panelMessageId","setDraftMentions","mentions","_this$drafts$dialogId","clearDraft","setRecentItemDraftText","_draft$text","Core","getStore","dispatch","getDraftMethodName","id","event","from","getData","name","getLayoutName","entityId","setTimeout","getDraft","clearTimeout","writeToStorageTimeout","saveToIndexedDb","prepareDrafts","TextareaPanelType","edit","Layout","chat","STORAGE_KEY$1","CopilotDraftManager","copilot","Lib","Event","Application","Dexie3","Const"],"sources":["draft.bundle.js"],"mappings":"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"}