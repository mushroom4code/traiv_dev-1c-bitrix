{"version":3,"file":"script.js","sources":["src/order.js","src/box.js","src/boxcollection.js","src/basketitemskeletonmodal.js","src/basketitemmovemodal.js","src/basketitemsplitmodal.js","src/basketitem.js","src/basket.js","src/basketitemcis.js","src/basketitemcissummary.js","src/basketitemdigital.js","src/basketitemdigitalsummary.js","src/basketconfirmform.js","src/basketconfirmsummary.js","src/shipmentprint.js","src/shipmentsubmit.js"],"sourcesContent":["const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Complex.extend({\r\n\r\n\tdefaults: {\r\n\t\tchildElement: '.js-yamarket-order__field',\r\n\t\tinputElement: '.js-yamarket-order__input',\r\n\t\tareaElement: '.js-yamarket-order__area',\r\n\t\trefreshUrl: null,\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleActivityEnd(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleActivityEnd(false);\r\n\t},\r\n\r\n\thandleActivityEnd: function(dir) {\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](this.el, 'yamarketActivitySubmitEnd', BX.proxy(this.onActivityEnd, this));\r\n\t},\r\n\r\n\tonActivityEnd: function() {\r\n\t\tthis.refresh();\r\n\t},\r\n\r\n\tgetId: function() {\r\n\t\tconst input = this.getInput('ID');\r\n\r\n\t\treturn input && input.val();\r\n\t},\r\n\r\n\tconfirm: function() {\r\n\t\tconst boxCollection = this.getChildField('BOX');\r\n\t\tconst basketConfirm = this.getChildField('BASKET_CONFIRM');\r\n\r\n\t\tif (!boxCollection || !basketConfirm) { return; }\r\n\r\n\t\treturn basketConfirm.confirm(boxCollection);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callChildList('validate');\r\n\t},\r\n\r\n\tcommit: function() {\r\n\t\tconst boxCollection = this.getChildField('BOX');\r\n\t\tlet hasChanges = false;\r\n\t\tlet boxIndex = 0;\r\n\r\n\t\tif (boxCollection == null) { return; }\r\n\r\n\t\tboxCollection.callItemList(function(box) {\r\n\t\t\tif (box.getBasket().commit(boxIndex)) {\r\n\t\t\t\thasChanges = true;\r\n\t\t\t}\r\n\r\n\t\t\t++boxIndex;\r\n\t\t});\r\n\r\n\t\thasChanges && this.refresh();\r\n\t},\r\n\r\n\trefresh: function() {\r\n\t\t$.ajax({ url: this.options.refreshUrl })\r\n\t\t\t.then($.proxy(this.updateArea, this));\r\n\t},\r\n\r\n\tupdateArea: function(html) {\r\n\t\tconst contents = $(html);\r\n\t\tconst newAreas = this.getElement('area', contents);\r\n\t\tconst newMap = this.mapAreas(newAreas);\r\n\t\tconst existsAreas = this.getElement('area');\r\n\t\tconst existsMap = this.mapAreas(existsAreas);\r\n\r\n\t\tfor (const type in newMap) {\r\n\t\t\tif (!newMap.hasOwnProperty(type)) { continue; }\r\n\t\t\tif (!existsMap.hasOwnProperty(type)) { continue; }\r\n\r\n\t\t\tconst newArea = newMap[type];\r\n\t\t\tconst existsArea = existsMap[type];\r\n\r\n\t\t\texistsArea.replaceWith(newArea);\r\n\r\n\t\t\tBX.onCustomEvent(newArea[0], 'onYaMarketContentUpdate', [\r\n\t\t\t\t{ target: newArea[0] }\r\n\t\t\t]);\r\n\t\t}\r\n\t},\r\n\r\n\tmapAreas: function(areas) {\r\n\t\tconst result = {};\r\n\r\n\t\tfor (let index = 0; index < areas.length; ++index) {\r\n\t\t\tconst area = areas.eq(index);\r\n\t\t\tconst type = area.data('type');\r\n\r\n\t\t\tif (!type) { continue; }\r\n\r\n\t\t\tresult[type] = area;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n}, {\r\n\tdataName: 'orderViewOrder',\r\n\tpluginName: 'YandexMarket.OrderView.Order',\r\n});\r\n\r\nexport const Order = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Complex.extend({\r\n\r\n\tdefaults: {\r\n\t\tselfElement: '.js-yamarket-box',\r\n\t\ttitleElement: '.js-yamarket-box__title',\r\n\t\tnumberElement: '.js-yamarket-box__number',\r\n\t\tinputElement: '.js-yamarket-box__input',\r\n\t\tchildElement: '.js-yamarket-box__child',\r\n\t\tdeleteElement: '.js-yamarket-box__delete',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BOX_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleDeleteClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleDeleteClick(false);\r\n\t},\r\n\r\n\thandleDeleteClick: function(dir) {\r\n\t\tconst deleteButton = this.getElement('delete');\r\n\r\n\t\tdeleteButton[dir ? 'on' : 'off']('click', $.proxy(this.onDeleteClick, this));\r\n\t},\r\n\r\n\tonDeleteClick: function(evt) {\r\n\t\tevt.preventDefault();\r\n\r\n\t\tif (this.onlyForPart()) {\r\n\t\t\tif (!confirm(this.getLang('DELETE_PART_BY_MERGE'))) { return; }\r\n\r\n\t\t\tthis.getBasket().callItemList('cancelSplit');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.getCollection().deleteItem(this.$el);\r\n\t},\r\n\r\n\tonlyForPart: function() {\r\n\t\tlet result = false;\r\n\r\n\t\tthis.getBasket().callItemList(function(basketItem) {\r\n\t\t\tif (basketItem.isPart()) {\r\n\t\t\t\tresult = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callChildList('validate');\r\n\t},\r\n\r\n\tgetTitle: function() {\r\n\t\tconst title = this.getElement('title');\r\n\r\n\t\treturn title && title.text().replace(/\\s+/g, ' ').trim();\r\n\t},\r\n\r\n\tsetIndex: function(index) {\r\n\t\tthis.callParent('setIndex', [index], constructor);\r\n\t\tthis.updateNumber(index);\r\n\t},\r\n\r\n\trefreshDelete: function(enabled) {\r\n\t\tthis.getElement('delete').prop('disabled', !enabled);\r\n\t},\r\n\r\n\trefreshNumber: function() {\r\n\t\tconst index = this.getIndex();\r\n\t\tthis.updateNumber(index);\r\n\t},\r\n\r\n\tupdateNumber: function(index) {\r\n\t\tthis.getElement('number').html('&numero;' + (index + 1));\r\n\t},\r\n\r\n\tgetBasket: function() {\r\n\t\treturn this.getChildField('ITEMS');\r\n\t},\r\n\r\n\tgetCollection: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n\tgetElement: function(key, context, method) {\r\n\t\tif (key === 'child') {\r\n\t\t\tconst keySelector = this.getElementSelector(key);\r\n\t\t\tconst selfSelector = this.getElementSelector('self');\r\n\r\n\t\t\treturn (context || this.$el).nextUntil(selfSelector, keySelector);\r\n\t\t}\r\n\r\n\t\treturn this.callParent('getElement', [key, context, method], constructor);\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBox',\r\n\tpluginName: 'YandexMarket.OrderView.Box',\r\n});\r\n\r\nexport const Box = constructor;","import {Box} from \"./box\";\r\n\r\nconst BX = window.BX;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\n\r\nconst constructor = Reference.Collection.extend({\r\n\r\n\tdefaults: {\r\n\t\titemElement: '.js-yamarket-box',\r\n\t\tfooterElement: 'tfoot',\r\n\t},\r\n\r\n\tgetCountChanges: function() {\r\n\t\tlet result = [];\r\n\r\n\t\tthis.callItemList(function(box) {\r\n\t\t\tresult = result.concat(box.getBasket().getCountChanges());\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetPreviousMovableBox: function(box) {\r\n\t\tlet previous;\r\n\t\tlet result;\r\n\r\n\t\tthis.callItemList(function(item) {\r\n\t\t\tif (item === box) {\r\n\t\t\t\tresult = previous;\r\n\t\t\t}\r\n\r\n\t\t\tif (!item.onlyForPart()) {\r\n\t\t\t\tprevious = item;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetNextMovableBox: function(box) {\r\n\t\tlet found = false;\r\n\t\tlet result;\r\n\r\n\t\tthis.callItemList(function(item) {\r\n\t\t\tif (found && result == null && !item.onlyForPart()) {\r\n\t\t\t\tresult = item;\r\n\t\t\t}\r\n\r\n\t\t\tif (item === box) {\r\n\t\t\t\tfound = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tcreateNew: function() {\r\n\t\treturn this.addItem();\r\n\t},\r\n\r\n\tsameBasketItems: function(basketItem) {\r\n\t\tlet result = [];\r\n\r\n\t\tthis.callItemList(function(box) {\r\n\t\t\tresult = result.concat(box.getBasket().sameBasketItems(basketItem));\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callItemList(function(box) {\r\n\t\t\ttry {\r\n\t\t\t\tbox.validate()\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconst title = box.getTitle();\r\n\t\t\t\tconst message = (title ? title + ': ' : '') + e.message;\r\n\r\n\t\t\t\tthrow new Error(message);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\taddItem: function(source, context, method, isCopy) {\r\n\t\tconst result = this.callParent('addItem', [source, context, method, isCopy], constructor);\r\n\r\n\t\tthis.refreshBoxNumber();\r\n\t\tthis.refreshBoxDelete();\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tdetachItem: function(item) {\r\n\t\tconst itemSelector = this.getElementSelector('item');\r\n\t\tconst footerSelector = this.getElementSelector('footer');\r\n\t\tconst siblings = item.nextUntil([itemSelector, footerSelector].join(', '));\r\n\r\n\t\tthis.callParent('detachItem', [item.add(siblings)], constructor);\r\n\t},\r\n\r\n\tcloneItem: function(sourceItem) {\r\n\t\tconst itemSelector = this.getElementSelector('item');\r\n\t\tconst footerSelector = this.getElementSelector('footer');\r\n\t\tconst siblings = sourceItem.nextUntil([itemSelector, footerSelector].join(', '));\r\n\r\n\t\treturn sourceItem.clone(false, false).add(siblings.clone(false, false));\r\n\t},\r\n\r\n\tappendItem: function(item, context, method) {\r\n\t\tif (method === 'after') {\r\n\t\t\tconst itemSelector = this.getElementSelector('item');\r\n\t\t\tconst footerSelector = this.getElementSelector('footer');\r\n\t\t\tconst next = context.nextAll([itemSelector, footerSelector].join(', '));\r\n\r\n\t\t\tif (next.length > 0) {\r\n\t\t\t\tcontext = next.eq(0);\r\n\t\t\t\tmethod = 'before';\r\n\t\t\t} else {\r\n\t\t\t\tcontext = context.parent();\r\n\t\t\t\tmethod = 'append';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcontext[method](item);\r\n\t\tPlugin.manager.initializeContext(item);\r\n\t},\r\n\r\n\tdeleteItem: function(item, silent) {\r\n\t\tthis.transferBasket(item);\r\n\t\tthis.callParent('deleteItem', [item, silent], constructor);\r\n\t\tthis.refreshBoxNumber();\r\n\t\tthis.refreshBoxDelete();\r\n\t},\r\n\r\n\ttransferBasket: function(item) {\r\n\t\tconst box = this.getItemInstance(item);\r\n\t\tconst basket = box.getBasket();\r\n\r\n\t\tif (basket.getActiveItems().length === 0) { return; }\r\n\r\n\t\tconst siblingBox = this.getPreviousMovableBox(box) ?? this.getNextMovableBox(box);\r\n\r\n\t\tif (siblingBox == null) { throw new Error('cant delete last box'); }\r\n\r\n\t\tbasket.callItemList('move', [siblingBox]);\r\n\t},\r\n\r\n\tinitializeItem: function(item, index, sourceItem) {\r\n\t\treturn this.callParent('initializeItem', [item.eq(0), index, sourceItem], constructor);\r\n\t},\r\n\r\n\trefreshBoxNumber: function() {\r\n\t\tthis.callItemList('refreshNumber');\r\n\t},\r\n\r\n\trefreshBoxDelete: function() {\r\n\t\tconst enabled = this.getActiveItems().length > 1;\r\n\r\n\t\tthis.callItemList('refreshDelete', [enabled]);\r\n\t},\r\n\r\n\tgetOrder: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n\tgetItemPlugin: function() {\r\n\t\treturn Box;\r\n\t}\r\n\r\n}, {\r\n\tdataName: 'orderViewBoxCollection',\r\n\tpluginName: 'YandexMarket.OrderView.BoxCollection',\r\n});\r\n\r\nexport const BoxCollection = constructor;","const BX = window.BX;\nconst $ = window.jQuery;\nconst YandexMarket = BX.namespace('YandexMarket');\nconst Plugin = BX.namespace('YandexMarket.Plugin');\n\nconst constructor = Plugin.Base.extend({\n\n\tdefaults: {\n\t\tmodalWidth: 400,\n\t\tmodalHeight: 150,\n\n\t\tlang: {},\n\t},\n\n\tinitVars: function() {\n\t\tthis.callParent('initVars', constructor);\n\t\tthis._modal = null;\n\t\tthis._openDeferred = null;\n\t},\n\n\thandleModal: function(modal, dir) {\n\t\tthis.handleModalSave(modal, dir);\n\t\tthis.handleModalClose(modal, dir);\n\t},\n\n\thandleModalSave: function(modal, dir) {\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](modal, 'onWindowSave', BX.proxy(this.onModalSave, this));\n\t},\n\n\thandleModalClose: function(modal, dir) {\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](modal, 'onWindowClose', BX.proxy(this.onModalClose, this));\n\t},\n\n\tonModalSave: function() {\n\t\tconst modal = this.modal();\n\n\t\tthis.resolve(modal);\n\t\tthis.handleModal(modal, false);\n\t\tthis.destroyModal(modal);\n\t\tmodal.Close();\n\t},\n\n\tonModalClose: function() {\n\t\tconst modal = this.modal(true);\n\n\t\tif (modal == null) { return; }\n\n\t\tthis.reject();\n\t\tthis.handleModal(modal, false);\n\t\tthis.destroyModal(modal);\n\t},\n\n\topen: function() {\n\t\tconst modal = this.modal();\n\n\t\tmodal.SetContent(this.$el.html());\n\t\tmodal.Show();\n\n\t\tthis.afterOpen(modal);\n\t\tthis.handleModal(modal, true);\n\n\t\treturn (this._openDeferred = new $.Deferred());\n\t},\n\n\tafterOpen: function(modal) {},\n\n\tresolve: function(modal) {\n\t\tif (this._openDeferred == null) { return; }\n\n\t\tthis._openDeferred.resolve(this.resolveValues(modal));\n\t\tthis._openDeferred = null;\n\t},\n\n\treject: function() {\n\t\tif (this._openDeferred == null) { return; }\n\n\t\tthis._openDeferred.reject();\n\t\tthis._openDeferred = null;\n\t},\n\n\tresolveValues: function(modal) {\n\t\treturn null;\n\t},\n\n\tmodal: function(skipCreate) {\n\t\tif (this._modal == null && !skipCreate) {\n\t\t\tthis._modal = new YandexMarket.EditDialog({\n\t\t\t\t'title': this.getLang('TITLE'),\n\t\t\t\t'draggable': true,\n\t\t\t\t'resizable': true,\n\t\t\t\t'buttons': [YandexMarket.EditDialog.btnSave, YandexMarket.EditDialog.btnCancel],\n\t\t\t\t'width': this.options.modalWidth,\n\t\t\t\t'height': this.options.modalHeight,\n\t\t\t});\n\t\t}\n\n\t\treturn this._modal;\n\t},\n\n\tmodalContent: function(modal) {\n\t\treturn $(modal.PARTS.CONTENT_DATA);\n\t},\n\n\tdestroyModal: function() {\n\t\tthis._modal = null;\n\t},\n\n});\n\nexport const BasketItemSkeletonModal = constructor;","import {BasketItemSkeletonModal} from \"./basketitemskeletonmodal\";\n\nconst $ = window.jQuery;\n\nconst constructor = BasketItemSkeletonModal.extend({\n\n\tdefaults: {\n\t\tcount: 1,\n\t\tcountElement: 'input[name=\"MOVE_COUNT\"]',\n\t\tboxElement: 'select[name=\"MOVE_BOX\"]',\n\n\t\tboxCollection: null,\n\t\tcurrentIndex: null,\n\t\tselectedIndex: null,\n\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_MOVE_',\n\t\tlang: {},\n\t},\n\n\tafterOpen: function(modal) {\n\t\tconst content = this.modalContent(modal);\n\n\t\tthis.renderCount(content);\n\t\tthis.renderBox(content);\n\t},\n\n\trenderCount: function(content) {\n\t\tconst input = this.getElement('count', content);\n\n\t\tinput.val(this.options.count);\n\t\tinput.prop('max', this.options.count);\n\t},\n\n\trenderBox: function(content) {\n\t\tconst select = this.getElement('box', content);\n\t\tconst boxes = this.options.boxCollection.getItemInstances();\n\n\t\tfor (let i = 0; i < boxes.length; i++) {\n\t\t\tconst box = boxes[i];\n\t\t\tconst boxIndex = box.getIndex() || 0;\n\n\t\t\tif (boxIndex === this.options.currentIndex || box.onlyForPart()) { continue; }\n\n\t\t\tconst option = $(`<option value=\"${boxIndex + 1}\">${box.getTitle()}</option>`);\n\n\t\t\toption.prependTo(select);\n\t\t\toption.prop('selected', boxIndex === this.options.selectedIndex);\n\t\t}\n\n\t\tif (this.options.selectedIndex == null) {\n\t\t\tselect.find('option').eq(-1).prop('selected', true);\n\t\t}\n\t},\n\n\tresolveValues: function(modal) {\n\t\tconst content = this.modalContent(modal);\n\n\t\treturn [\n\t\t\tthis.resolvedBox(content),\n\t\t\tthis.resolvedCount(content),\n\t\t];\n\t},\n\n\tresolvedBox: function(content) {\n\t\tconst select = this.getElement('box', content);\n\t\tconst selected = parseInt(select.val()) || 0;\n\n\t\tif (selected === 0) { return this.options.boxCollection.createNew(); }\n\n\t\tconst boxElement = this.options.boxCollection.getItem(selected - 1);\n\n\t\tif (boxElement == null) { throw new Error(`cant find box with index ${selected}`); }\n\n\t\treturn this.options.boxCollection.getItemInstance(boxElement);\n\t},\n\n\tresolvedCount: function(content) {\n\t\tconst input = this.getElement('count', content);\n\n\t\treturn parseInt(input.val()) || 1;\n\t},\n\n});\n\nexport const BasketItemMoveModal = constructor;","import {BasketItemSkeletonModal} from \"./basketitemskeletonmodal\";\n\nconst constructor = BasketItemSkeletonModal.extend({\n\n\tdefaults: {\n\t\tcountElement: 'input[name=\"SPLIT_COUNT\"]',\n\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_SPLIT_',\n\t\tlang: {},\n\t},\n\n\tresolveValues: function(modal) {\n\t\tconst input = this.getElement('count', this.modalContent(modal));\n\n\t\treturn parseInt(input.val().trim()) || 1;\n\t},\n\n});\n\nexport const BasketItemSplitModal = constructor;","import { BasketItemMoveModal } from \"./basketitemmovemodal\";\r\nimport { BasketItemSplitModal } from \"./basketitemsplitmodal\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Complex.extend({\r\n\r\n\tdefaults: {\r\n\t\tid: null,\r\n\r\n\t\tchildElement: '.js-yamarket-basket-item__field',\r\n\t\tinputElement: '.js-yamarket-basket-item__data',\r\n\r\n\t\tupElement: '.js-yamarket-basket-item__up',\r\n\t\tmoreElement: '.js-yamarket-basket-item__more',\r\n\t\tdownElement: '.js-yamarket-basket-item__down',\r\n\t\tsplitElement: '.js-yamarket-basket-item__split',\r\n\t\tsplitModalElement: '#yamarket-basket-split-modal',\r\n\t\tmoveModalElement: '#yamarket-basket-move-modal',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._moreDropdown = null;\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleCountChange(true);\r\n\t\tthis.handleUp(true);\r\n\t\tthis.handleDown(true);\r\n\t\tthis.handleMore(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleCountChange(false);\r\n\t\tthis.handleUp(false);\r\n\t\tthis.handleDown(false);\r\n\t\tthis.handleMore(false);\r\n\t},\r\n\r\n\thandleCountChange: function(dir) {\r\n\t\tconst input = this.getInput('COUNT');\r\n\r\n\t\tif (!input) { return; }\r\n\r\n\t\tinput[dir ? 'on' : 'off']('change',  $.proxy(this.onCountChange, this));\r\n\t},\r\n\r\n\thandleUp: function(dir) {\r\n\t\tthis.getElement('up')[dir ? 'on' : 'off']('click',  $.proxy(this.onUp, this));\r\n\t},\r\n\r\n\thandleDown: function(dir) {\r\n\t\tthis.getElement('down')[dir ? 'on' : 'off']('click',  $.proxy(this.onDown, this));\r\n\t},\r\n\r\n\thandleMore: function(dir) {\r\n\t\tthis.getElement('more')[dir ? 'on' : 'off']('click',  $.proxy(this.onMore, this));\r\n\t},\r\n\r\n\tonCountChange: function() {\r\n\t\tthis.updateCisCount();\r\n\t},\r\n\r\n\tonUp: function() {\r\n\t\tconst box = this.getBasket().getBox();\r\n\t\tconst boxCollection = box.getCollection();\r\n\r\n\t\tthis.moveStart(boxCollection, box, boxCollection.getPreviousMovableBox(box));\r\n\t},\r\n\r\n\tonDown: function() {\r\n\t\tconst box = this.getBasket().getBox();\r\n\t\tconst boxCollection = box.getCollection();\r\n\r\n\t\tthis.moveStart(boxCollection, box, boxCollection.getNextMovableBox(box));\r\n\t},\r\n\r\n\tonMore: function(evt) {\r\n\t\tconst menu = this.moreDropdown(evt.currentTarget);\r\n\r\n\t\tmenu.setItems(this.moreMenuItems());\r\n\t\tmenu.Show();\r\n\t},\r\n\r\n\tid: function() {\r\n\t\treturn this.getInput('ID').val();\r\n\t},\r\n\r\n\tmoveStart: function(boxCollection, currentBox, selectedBox) {\r\n\t\tconst count = this.getCount();\r\n\r\n\t\tif (count <= 1) {\r\n\t\t\tconst newItem = this.move(selectedBox ?? boxCollection.createNew());\r\n\r\n\t\t\tnewItem.recalculateOffset();\r\n\t\t\tnewItem.getBasket().refreshItemMove();\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t(new BasketItemMoveModal(this.getElement('moveModal'), {\r\n\t\t\tcount: count,\r\n\t\t\tcurrentIndex: currentBox.getIndex(),\r\n\t\t\tselectedIndex: selectedBox != null ? selectedBox.getIndex() : null,\r\n\t\t\tboxCollection: boxCollection,\r\n\t\t}))\r\n\t\t\t.open()\r\n\t\t\t.then((resolved) => {\r\n\t\t\t\tconst [box, moveCount] = resolved;\r\n\t\t\t\tlet newItem;\r\n\r\n\t\t\t\tif (moveCount < count) {\r\n\t\t\t\t\tnewItem = this.move(box, moveCount, true);\r\n\r\n\t\t\t\t\tthis.setCount(this.getCount() - moveCount);\r\n\t\t\t\t\tthis.setInitialCount(this.getInitialCount() - moveCount);\r\n\t\t\t\t\tthis.recalculateOffset();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewItem = this.move(box);\r\n\t\t\t\t\tnewItem.recalculateOffset();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnewItem.getBasket().refreshItemMove();\r\n\t\t\t});\r\n\t},\r\n\r\n\tmove: function(newBox, count, needClone) {\r\n\t\tconst newBasket = newBox.getBasket();\r\n\t\tconst sameItems = newBasket.sameBasketItems(this);\r\n\t\tconst basket = this.getBasket();\r\n\t\tconst box = basket.getBox();\r\n\t\tlet newItem;\r\n\r\n\t\tif (sameItems.length > 0) {\r\n\t\t\tnewItem = sameItems[0];\r\n\r\n\t\t\tif (count == null) { count = this.getCount(); }\r\n\r\n\t\t\tnewItem.setCount(newItem.getCount() + count);\r\n\t\t\tnewItem.setInitialCount(newItem.getInitialCount() + count);\r\n\r\n\t\t\t!needClone && basket.deleteItem(this.$el);\r\n\t\t} else {\r\n\t\t\tnewItem = newBox.getBasket().insertItem(needClone ? this.$el.clone(false, false) : this.$el);\r\n\r\n\t\t\tif (count != null) {\r\n\t\t\t\tnewItem.setCount(count);\r\n\t\t\t\tnewItem.setInitialCount(count);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (basket.getActiveItems().length === 0) {\r\n\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t} else {\r\n\t\t\tbasket.refreshItemMove();\r\n\t\t}\r\n\r\n\t\treturn newItem;\r\n\t},\r\n\r\n\tmoreDropdown: function(anchor) {\r\n\t\tif (this._moreDropdown == null) {\r\n\t\t\tthis._moreDropdown = new BX.CMenu({\r\n\t\t\t\tATTACH_MODE: 'bottom',\r\n\t\t\t\tSET_ID: 'bx-admin-prefix',\r\n\t\t\t\tCLOSE_ON_CLICK: true,\r\n\t\t\t\tparent: anchor,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this._moreDropdown;\r\n\t},\r\n\r\n\tmoreMenuItems: function() {\r\n\t\tconst values = this.getValue();\r\n\r\n\t\treturn (\r\n\t\t\tthis.moreMenuItemsForSplit(values)\r\n\t\t\t\t.concat(this.moreMenuItemsForDelete(values))\r\n\t\t);\r\n\t},\r\n\r\n\tmoreMenuItemsForDelete: function(values) {\r\n\t\tif (values['DELETE'] == null || values['PARTIAL_CURRENT']) { return []; }\r\n\r\n\t\tconst result = [];\r\n\r\n\t\tif (values['DELETE']) {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.markDeleted, this, false),\r\n\t\t\t\tTEXT: this.getLang('CANCEL_DELETE'),\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.markDeleted, this, true),\r\n\t\t\t\tTEXT: this.getLang('DELETE'),\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tmoreMenuItemsForSplit: function(values) {\r\n\t\tif (values['PARTIAL_CURRENT'] == null || values['DELETE']) { return []; }\r\n\r\n\t\tconst result = [];\r\n\r\n\t\tif (values['PARTIAL_CURRENT']) {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.cancelSplit, this),\r\n\t\t\t\tTEXT: this.getLang('CANCEL_SPLIT'),\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.splitStart, this),\r\n\t\t\t\tTEXT: this.getLang('SPLIT'),\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tmarkDeleted: function(deleted) {\r\n\t\tthis.getInput('DELETE').val(deleted ? 'Y' : '');\r\n\t\tthis.$el.toggleClass('is--deleted', !!deleted);\r\n\t},\r\n\r\n\tcancelSplit: function() {\r\n\t\tconst parts = this.getBasket().getBox().getCollection().sameBasketItems(this);\r\n\t\tconst [count, initialCount] = this.countSiblings(parts);\r\n\t\tlet first = true;\r\n\r\n\t\tfor (const part of parts) {\r\n\t\t\tif (first) {\r\n\t\t\t\tconst basket = part.getBasket();\r\n\t\t\t\tconst box = basket.getBox();\r\n\t\t\t\tconst previousBox = box.getCollection().getPreviousMovableBox(box) ?? box.getCollection().getNextMovableBox(box);\r\n\r\n\t\t\t\tpart.resetPart();\r\n\t\t\t\tpart.setCount(count);\r\n\t\t\t\tpart.setInitialCount(initialCount);\r\n\t\t\t\tpart.setOffset(0);\r\n\t\t\t\tpart.updateCisCount();\r\n\r\n\t\t\t\tif (previousBox != null) {\r\n\t\t\t\t\tpart.move(previousBox);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpart.getBasket().refreshItemMove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfirst = false;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst basket = part.getBasket();\r\n\t\t\tconst box = basket.getBox();\r\n\r\n\t\t\tbasket.deleteItem(part.$el);\r\n\r\n\t\t\tif (basket.getActiveItems().length === 0) {\r\n\t\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tcountSiblings: function(basketItems) {\r\n\t\tlet count = 0;\r\n\t\tlet initialCount = 0;\r\n\r\n\t\tfor (const basketItem of basketItems) {\r\n\t\t\tif (!basketItem.isPart() || basketItem.isFinalPart()) {\r\n\t\t\t\tcount += basketItem.getCount() || 0;\r\n\t\t\t\tinitialCount += basketItem.getInitialCount() || 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [count, initialCount];\r\n\t},\r\n\r\n\tsplitStart: function() {\r\n\t\t(new BasketItemSplitModal(this.getElement('splitModal')))\r\n\t\t\t.open()\r\n\t\t\t.then((total) => this.split(total));\r\n\t},\r\n\r\n\tsplit: function(total) {\r\n\t\tconst basket = this.getBasket();\r\n\t\tconst boxCollection = basket.getBox().getCollection();\r\n\t\tconst [deletedCount, deletedInitialCount] = this.removeSiblings();\r\n\t\tconst count = (this.getCount() || 1) + deletedCount;\r\n\t\tconst initialCount = (this.getInitialCount() || 1) + deletedInitialCount;\r\n\t\tlet lastItem;\r\n\r\n\t\tfor (let productIndex = 0; productIndex < count; ++productIndex) {\r\n\t\t\tfor (let i = 0; i < total; ++i) {\r\n\t\t\t\tconst isSelf = (productIndex === 0 && i === 0);\r\n\t\t\t\tconst newItem = this.move(boxCollection.createNew(), 1, !isSelf);\r\n\r\n\t\t\t\tnewItem.setPart(i, total);\r\n\r\n\t\t\t\tif (productIndex === 0) {\r\n\t\t\t\t\tnewItem.setInitialCount(1 + (initialCount - count));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlastItem = newItem;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlastItem?.recalculateOffset();\r\n\t},\r\n\r\n\tremoveSiblings() {\r\n\t\tconst sameItems = this.getBasket().getBox().getCollection().sameBasketItems(this);\r\n\t\tlet deletedCount = 0;\r\n\t\tlet deletedInitialCount = 0;\r\n\r\n\t\tfor (const sameItem of sameItems) {\r\n\t\t\tif (sameItem === this) { continue; }\r\n\r\n\t\t\tconst basket = sameItem.getBasket();\r\n\r\n\t\t\tdeletedCount += sameItem.getCount() || 0;\r\n\t\t\tdeletedInitialCount += sameItem.getInitialCount() || 0;\r\n\r\n\t\t\tbasket.deleteItem(sameItem.$el);\r\n\r\n\t\t\tif (basket.getActiveItems().length === 0) {\r\n\t\t\t\tconst box = basket.getBox();\r\n\t\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [deletedCount, deletedInitialCount];\r\n\t},\r\n\r\n\tresetPart: function() {\r\n\t\tconst currentInput = this.getInput('PARTIAL_CURRENT');\r\n\t\tconst totalInput = this.getInput('PARTIAL_TOTAL');\r\n\t\tconst nameElement = this.getInput('PARTIAL_NAME');\r\n\r\n\t\tthis.$el.removeClass('is--partial');\r\n\t\tcurrentInput.val('');\r\n\t\ttotalInput.val('');\r\n\t\tnameElement.text('');\r\n\t},\r\n\r\n\tsetPart: function(index, total) {\r\n\t\tconst currentInput = this.getInput('PARTIAL_CURRENT');\r\n\t\tconst totalInput = this.getInput('PARTIAL_TOTAL');\r\n\t\tconst nameElement = this.getInput('PARTIAL_NAME');\r\n\r\n\t\tthis.$el.addClass('is--partial');\r\n\t\tcurrentInput.val(index + 1);\r\n\t\ttotalInput.val(total);\r\n\t\tnameElement.text(`${this.getLang('PART')} ${index + 1}/${total}`);\r\n\t},\r\n\r\n\trefreshMoveUp: function(canMoveUp) {\r\n\t\tthis.getElement('up').prop('disabled', !canMoveUp || this.isPart());\r\n\t},\r\n\r\n\trefreshMoveDown: function(canMoveDown) {\r\n\t\tif (!canMoveDown && this.getCount() > 1) {\r\n\t\t\tcanMoveDown = true;\r\n\t\t}\r\n\r\n\t\tthis.getElement('down').prop('disabled', !canMoveDown || this.isPart());\r\n\t},\r\n\r\n\tupdateCisCount: function() {\r\n\t\tconst count = this.getCount();\r\n\t\tconst offset = this.getOffset();\r\n\t\tconst isValid = (count > 0);\r\n\t\tconst fields = [\r\n\t\t\tthis.getCis(),\r\n\t\t\tthis.getDigital(),\r\n\t\t];\r\n\r\n\t\tif (!isValid) { return; }\r\n\r\n\t\tfor (const field of fields) {\r\n\t\t\tif (field == null) { continue; }\r\n\r\n\t\t\tfield.setBasketCount(count, offset);\r\n\t\t\tfield.refreshSummary();\r\n\t\t}\r\n\t},\r\n\r\n\tisPart: function() {\r\n\t\tconst input = this.getInput('PARTIAL_CURRENT');\r\n\r\n\t\treturn input && !!(input.val());\r\n\t},\r\n\r\n\tisFinalPart: function() {\r\n\t\tconst currentInput = this.getInput('PARTIAL_CURRENT');\r\n\t\tconst currentValue = currentInput && parseInt(currentInput.val()) || 0;\r\n\t\tconst totalInput = this.getInput('PARTIAL_TOTAL');\r\n\t\tconst totalValue = totalInput && parseInt(totalInput.val()) || 0;\r\n\r\n\t\treturn (currentValue > 0 && currentValue === totalValue);\r\n\t},\r\n\r\n\tcommit: function(boxIndex) {\r\n\t\tconst count = this.getCount();\r\n\t\tconst initialCount = this.getInitialCount();\r\n\t\tconst boxIndexInput = this.getInput('INITIAL_BOX');\r\n\t\tlet changed = false;\r\n\r\n\t\tif (count !== initialCount) {\r\n\t\t\tchanged = true;\r\n\t\t\tthis.setInitialCount(count);\r\n\t\t}\r\n\r\n\t\tboxIndexInput && boxIndexInput.val(boxIndex);\r\n\r\n\t\treturn changed;\r\n\t},\r\n\r\n\tgetTitle: function() {\r\n\t\tconst name = this.getInput('NAME');\r\n\r\n\t\treturn name && name.text();\r\n\t},\r\n\r\n\tgetCountDiff: function() {\r\n\t\tlet result;\r\n\r\n\t\tif (this.needDelete()) {\r\n\t\t\tresult = this.getInitialCount();\r\n\t\t} else {\r\n\t\t\tresult = this.getInitialCount() - this.getCount();\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tsetCount: function(count) {\r\n\t\tconst input = this.getInput('COUNT');\r\n\r\n\t\tinput.val(count);\r\n\t},\r\n\r\n\tgetCount: function() {\r\n\t\tconst input = this.getInput('COUNT');\r\n\r\n\t\treturn input !== null ? parseInt(input.val()) : null;\r\n\t},\r\n\r\n\trecalculateOffset: function() {\r\n\t\tconst sameItems = this.getBasket().getBox().getCollection().sameBasketItems(this);\r\n\t\tlet offset = 0;\r\n\r\n\t\tfor (const sameItem of sameItems) {\r\n\t\t\tsameItem.setOffset(offset);\r\n\r\n\t\t\tif (!sameItem.isPart() || sameItem.isFinalPart()) {\r\n\t\t\t\toffset += sameItem.getInitialCount();\r\n\t\t\t}\r\n\r\n\t\t\tsameItem.updateCisCount();\r\n\t\t}\r\n\t},\r\n\r\n\tsetOffset: function(offset) {\r\n\t\tconst input = this.getInput('OFFSET');\r\n\r\n\t\tinput.val(offset || 0);\r\n\t},\r\n\r\n\tgetOffset: function() {\r\n\t\tconst input = this.getInput('OFFSET');\r\n\r\n\t\treturn input !== null ? parseInt(input.val()) : null;\r\n\t},\r\n\r\n\tgetInitialCount: function() {\r\n\t\tconst input = this.getInput('INITIAL_COUNT');\r\n\r\n\t\treturn input !== null ? parseInt(input.val()) : null;\r\n\t},\r\n\r\n\tsetInitialCount: function(count) {\r\n\t\tconst countInput = this.getInput('COUNT');\r\n\t\tconst initialInput = this.getInput('INITIAL_COUNT');\r\n\r\n\t\tinitialInput?.val(count);\r\n\t\tcountInput?.prop('max', count);\r\n\t},\r\n\r\n\tneedDelete: function() {\r\n\t\tconst input = this.getInput('DELETE');\r\n\r\n\t\treturn input && input.val() === 'Y';\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tif (this.needDelete()) { return; }\r\n\r\n\t\tconst fields = [\r\n\t\t\tthis.getCis(),\r\n\t\t\tthis.getDigital(),\r\n\t\t];\r\n\r\n\t\tfor (const field of fields) {\r\n\t\t\tfield && field.validate();\r\n\t\t}\r\n\t},\r\n\r\n\tgetCis: function() {\r\n\t\treturn this.getChildField('IDENTIFIERS');\r\n\t},\r\n\r\n\tgetDigital: function() {\r\n\t\treturn this.getChildField('DIGITAL');\r\n\t},\r\n\r\n\tgetBasket: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItem',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItem',\r\n});\r\n\r\nexport const BasketItem = constructor;","import { BasketItem } from \"./basketitem\";\r\n\r\nconst BX = window.BX;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Collection.extend({\r\n\r\n\tdefaults: {\r\n\t\titemElement: '.js-yamarket-basket-item'\r\n\t},\r\n\r\n\tinsertItem: function(itemElement) {\r\n\t\titemElement.detach();\r\n\t\titemElement.addClass('is--hidden');\r\n\t\titemElement.appendTo(this.$el);\r\n\r\n\t\treturn this.addItem(itemElement, null, null, true);\r\n\t},\r\n\r\n\tsameBasketItems: function(target) {\r\n\t\tconst targetId = target.id();\r\n\t\tconst result = [];\r\n\r\n\t\tthis.callItemList((item) => {\r\n\t\t\tif (item.id() === targetId) {\r\n\t\t\t\tresult.push(item);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\taddItem: function(source, context, method, isCopy) {\r\n\t\tconst item = this.callParent('addItem', [source, context, method, isCopy], constructor);\r\n\r\n\t\tthis.refreshItemMove();\r\n\r\n\t\treturn item;\r\n\t},\r\n\r\n\tdeleteItem: function(item, silent) {\r\n\t\tthis.callParent('deleteItem', [item, silent], constructor);\r\n\t\tthis.refreshItemMove();\r\n\t},\r\n\r\n\trefreshItemMove: function() {\r\n\t\tconst box = this.getBox();\r\n\t\tconst previousBox = box.getCollection().getPreviousMovableBox(box);\r\n\t\tconst nextBox = box.getCollection().getNextMovableBox(box);\r\n\t\tconst hasPrevious = previousBox != null && previousBox.getBasket().getActiveItems().length > 0;\r\n\t\tconst hasNext = nextBox != null && nextBox.getBasket().getActiveItems().length > 0;\r\n\t\tconst hasFewItems = this.getActiveItems().length > 1;\r\n\r\n\t\tthis.callItemList('refreshMoveUp', [hasPrevious]);\r\n\t\tthis.callItemList('refreshMoveDown', [hasNext || hasFewItems]);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callItemList((basketItem) => {\r\n\t\t\ttry {\r\n\t\t\t\tbasketItem.validate()\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconst title = basketItem.getTitle();\r\n\t\t\t\tconst message = (title ? title + ': ' : '') + e.message;\r\n\r\n\t\t\t\tthrow new Error(message);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tcommit: function(boxIndex) {\r\n\t\tlet hasChanges = false;\r\n\t\tlet activeCount = 0;\r\n\r\n\t\tthis.callItemList((basketItem) => {\r\n\t\t\tlet count = basketItem.getCount();\r\n\r\n\t\t\tif (count <= 0 || basketItem.needDelete()) {\r\n\t\t\t\thasChanges = true;\r\n\t\t\t\tthis.deleteItem(basketItem.$el);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (basketItem.commit(boxIndex)) {\r\n\t\t\t\thasChanges = true;\r\n\t\t\t}\r\n\r\n\t\t\t++activeCount;\r\n\t\t});\r\n\r\n\t\tif (activeCount === 0) {\r\n\t\t\tconst box = this.getBox();\r\n\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t}\r\n\r\n\t\treturn hasChanges;\r\n\t},\r\n\r\n\tgetCountChanges: function() {\r\n\t\tconst result = [];\r\n\r\n\t\tthis.callItemList((basketItem) => {\r\n\t\t\tlet diff = basketItem.getCountDiff();\r\n\r\n\t\t\tif (diff <= 0 || (basketItem.isPart() && !basketItem.isFinalPart())) { return; }\r\n\r\n\t\t\tresult.push({\r\n\t\t\t\tname: basketItem.getTitle(),\r\n\t\t\t\tdiff: diff,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetItemPlugin: function() {\r\n\t\treturn BasketItem;\r\n\t},\r\n\r\n\tgetBox: function() {\r\n\t\treturn this.getParentField();\r\n\t}\r\n\r\n}, {\r\n\tdataName: 'orderViewBasket',\r\n\tpluginName: 'YandexMarket.OrderView.Basket',\r\n});\r\n\r\nexport const Basket = constructor;","const BX = window.BX;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tinputElement: '.js-yamarket-basket-item-cis__input',\r\n\t\tcopyElement: '.js-yamarket-basket-item-cis__copy',\r\n\t\trowElement: '.js-yamarket-basket-item-cis__row',\r\n\t\tcopy: null,\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_CIS_'\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleCopyClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleCopyClick(false);\r\n\t},\r\n\r\n\thandleCopyClick: function(dir) {\r\n\t\tconst copy = this.getElement('copy');\r\n\r\n\t\tcopy[dir ? 'on' : 'off']('click', $.proxy(this.onCopyClick, this));\r\n\t},\r\n\r\n\tonCopyClick: function(evt) {\r\n\t\tthis.copy();\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tcopy: function() {\r\n\t\tconst copyValues = this.getCopyValue();\r\n\t\tconst values = this.getValue();\r\n\r\n\t\tObject.assign(values, copyValues);\r\n\r\n\t\tthis.setValue(values);\r\n\t},\r\n\r\n\tgetCopyValue: function() {\r\n\t\tconst parent = this.getParentField();\r\n\t\tlet result;\r\n\r\n\t\tif (this.options.copy != null) {\r\n\t\t\tresult = this.options.copy;\r\n\t\t} else if (parent != null) {\r\n\t\t\tresult = parent.getCopyValue();\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tsetBasketCount: function(count, offset) {\r\n\t\tconst rows = this.getElement('row');\r\n\r\n\t\tfor (let i = 0; i < rows.length; ++i) {\r\n\t\t\tconst row = rows.eq(i);\r\n\r\n\t\t\tif (i >= offset && i < offset + count) {\r\n\t\t\t\trow.removeClass('is--hidden');\r\n\t\t\t\trow.find('input').prop('disabled', false);\r\n\t\t\t} else {\r\n\t\t\t\trow.addClass('is--hidden');\r\n\t\t\t\trow.find('input').prop('disabled', true);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemCis',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemCis',\r\n});\r\n\r\nexport const BasketItemCis = constructor;","import {BasketItemCis} from \"./basketitemcis\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst YandexMarket = BX.namespace('YandexMarket');\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Summary.extend({\r\n\r\n\tdefaults: {\r\n\t\tsummaryElement: '.js-yamarket-basket-item-cis__summary',\r\n\t\tfieldElement: '.js-yamarket-basket-item-cis__field',\r\n\t\tmodalElement: '.js-yamarket-basket-item-cis__modal',\r\n\t\tmodalWidth: 400,\r\n\t\tmodalHeight: 300,\r\n\t\trequiredTypes: '',\r\n\r\n\t\tcopyElement: '.js-yamarket-basket-item-cis__summary-copy',\r\n\t\tcopy: null,\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_CIS_'\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleSummaryClick(true);\r\n\t\tthis.handleCopyClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleSummaryClick(false);\r\n\t\tthis.handleCopyClick(false);\r\n\t},\r\n\r\n\thandleSummaryClick: function(dir) {\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary[dir ? 'on' : 'off']('click', $.proxy(this.onSummaryClick, this));\r\n\t},\r\n\r\n\thandleCopyClick: function(dir) {\r\n\t\tconst copy = this.getElement('copy');\r\n\r\n\t\tcopy[dir ? 'on' : 'off']('click', $.proxy(this.onCopyClick, this));\r\n\t},\r\n\r\n\tonSummaryClick: function(evt) {\r\n\t\tthis.openEditModal();\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tonCopyClick: function(evt) {\r\n\t\tthis.copy();\r\n\t\tthis.refreshSummary();\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tupdateField: function(modalContent) {\r\n\t\tthis.callParent('updateField', [modalContent], constructor);\r\n\t\tthis.syncSameBasketItems();\r\n\t},\r\n\r\n\tsyncSameBasketItems: function() {\r\n\t\tconst ourBasketItem = this.getBasketItem();\r\n\t\tconst sameBasketItems = ourBasketItem.getBasket().getBox().getCollection().sameBasketItems(ourBasketItem);\r\n\r\n\t\tif (sameBasketItems.length === 1) { return; }\r\n\r\n\t\tconst fieldName = this.$el.data('name');\r\n\t\tconst value = this.getValue();\r\n\r\n\t\tfor (const siblingBasketItem of sameBasketItems) {\r\n\t\t\tif (siblingBasketItem === ourBasketItem) { continue; }\r\n\r\n\t\t\tconst siblingCis = siblingBasketItem.getChildField(fieldName);\r\n\r\n\t\t\tif (siblingCis == null) { continue; }\r\n\r\n\t\t\tsiblingCis.setValue(value);\r\n\r\n\t\t\tif (siblingBasketItem.isPart()) {\r\n\t\t\t\tsiblingCis.refreshSummary();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tconst valueList = this.getValue();\r\n\t\tconst status = this.getCisStatus(valueList);\r\n\r\n\t\tif (status === 'WAIT') {\r\n\t\t\tthrow new Error(this.getLang('REQUIRED'));\r\n\t\t}\r\n\t},\r\n\r\n\trefreshSummary: function() {\r\n\t\tconst valueList = this.getValue();\r\n\t\tconst status = this.getCisStatus(valueList);\r\n\t\tconst statusText = this.getLang('SUMMARY_' + status) || status;\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary.text(statusText);\r\n\t\tsummary.attr('data-status', status);\r\n\t},\r\n\r\n\tgetCisStatus: function(valueList) {\r\n\t\tconst basketItem = this.getBasketItem();\r\n\t\tconst count = basketItem.getCount();\r\n\t\tconst filled = this.getFilledCount(valueList, count, basketItem.getOffset());\r\n\t\tlet result;\r\n\r\n\t\tif (filled >= count) {\r\n\t\t\tresult = 'READY';\r\n\t\t} else {\r\n\t\t\tresult = 'WAIT';\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetFilledCount: function(valueList, count, offset) {\r\n\t\tconst types = this.requiredTypes();\r\n\t\tlet result = 0;\r\n\r\n\t\tfor (let i = offset; i < offset + count; ++i) {\r\n\t\t\tlet itemFilled = 0;\r\n\r\n\t\t\tfor (const type of types) {\r\n\t\t\t\tconst name = `[ITEMS][${i}][${type}]`;\r\n\t\t\t\tconst value = valueList[name] ?? '';\r\n\r\n\t\t\t\tif (value.trim() !== '') {\r\n\t\t\t\t\t++itemFilled;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (itemFilled >= types.length) {\r\n\t\t\t\t++result;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetBasketCount: function() {\r\n\t\treturn this.getBasketItem().getCount();\r\n\t},\r\n\r\n\tsetBasketCount: function(count, offset) {\r\n\t\tthis.callField('setBasketCount', [count, offset]);\r\n\t},\r\n\r\n\trequiredTypes: function() {\r\n\t\tconst option = this.options.requiredTypes || '';\r\n\r\n\t\treturn option.split(',');\r\n\t},\r\n\r\n\tcopy: function() {\r\n\t\tconst copyValues = this.getCopyValue();\r\n\t\tconst values = this.getValue();\r\n\r\n\t\tObject.assign(values, copyValues);\r\n\r\n\t\tthis.setValue(values);\r\n\t},\r\n\r\n\tgetCopyValue: function() {\r\n\t\treturn this.options.copy;\r\n\t},\r\n\r\n\tgetFieldPlugin: function() {\r\n\t\treturn BasketItemCis;\r\n\t},\r\n\r\n\tgetBasketItem: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n\tcreateModal: function() {\r\n\t\treturn new YandexMarket.EditDialog({\r\n\t\t\t'title': this.options.title,\r\n\t\t\t'draggable': true,\r\n\t\t\t'resizable': true,\r\n\t\t\t'buttons': [YandexMarket.EditDialog.btnSave, YandexMarket.EditDialog.btnCancel],\r\n\t\t\t'width': this.options.modalWidth,\r\n\t\t\t'height': this.options.modalHeight\r\n\t\t});\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemCisSummary',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemCisSummary',\r\n});\r\n\r\nexport const BasketItemCisSummary = constructor;","const BX = window.BX;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tinputElement: '.js-yamarket-basket-item-digital__input',\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_DIGITAL_'\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemDigital',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemDigital',\r\n});\r\n\r\nexport const BasketItemDigital = constructor;","import {BasketItemDigital} from \"./basketitemdigital\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Summary.extend({\r\n\r\n\tdefaults: {\r\n\t\tsummaryElement: '.js-yamarket-basket-item-digital__summary',\r\n\t\tfieldElement: '.js-yamarket-basket-item-digital__field',\r\n\t\tmodalElement: '.js-yamarket-basket-item-digital__modal',\r\n\t\tmodalWidth: 450,\r\n\t\tmodalBaseHeight: 160,\r\n\t\tmodalOneHeight: 140,\r\n\t\tcount: 1,\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_DIGITAL_'\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._basketCount = null;\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleSummaryClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleSummaryClick(false);\r\n\t},\r\n\r\n\thandleSummaryClick: function(dir) {\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary[dir ? 'on' : 'off']('click', $.proxy(this.onSummaryClick, this));\r\n\t},\r\n\r\n\tonSummaryClick: function(evt) {\r\n\t\tthis.resolveModalHeight();\r\n\t\tthis.openEditModal();\r\n\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tresolveModalHeight: function() {\r\n\t\tthis.options.modalHeight = this.options.modalBaseHeight + (this.options.modalOneHeight * this.options.count);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tconst raw = this.getValue();\r\n\t\tconst values = this.parseValue(raw);\r\n\t\tconst status = this.getDigitalStatus(values);\r\n\r\n\t\tif (status === 'WAIT') {\r\n\t\t\tthrow new Error(this.getLang('REQUIRED'));\r\n\t\t}\r\n\t},\r\n\r\n\trefreshSummary: function() {\r\n\t\tconst raw = this.getValue();\r\n\t\tconst values = this.parseValue(raw);\r\n\t\tconst status = this.getDigitalStatus(values);\r\n\t\tconst statusText = this.getLang('SUMMARY_' + status) || status;\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary.text(statusText);\r\n\t\tsummary.attr('data-status', status);\r\n\t},\r\n\r\n\tparseValue: function(values) {\r\n\t\tconst result = {};\r\n\r\n\t\tfor (const key in values) {\r\n\t\t\tif (!values.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\tconst keyChain = this.valueKeyChain(key);\r\n\r\n\t\t\tthis.setValueByKeyChain(result, keyChain, values[key]);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tvalueKeyChain: function(key) {\r\n\t\tconst parts = key.split('[');\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const part of parts) {\r\n\t\t\tif (part === '' && result.length === 0) { continue; }\r\n\r\n\t\t\tconst name = part.replace(/]$/, '');\r\n\r\n\t\t\tresult.push(name);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tsetValueByKeyChain: function(result, chain, value) {\r\n\t\tconst lastKey = chain.pop();\r\n\t\tlet level = result;\r\n\r\n\t\tfor (let index = 0; index < chain.length; ++index) {\r\n\t\t\tconst key = chain[index];\r\n\t\t\tconst nextKey = (index + 1 === chain.length) ? lastKey : chain[index + 1];\r\n\r\n\t\t\tif (level[key] == null) {\r\n\t\t\t\tlevel[key] = /^\\d+$/.test(nextKey) ? [] : {};\r\n\t\t\t}\r\n\r\n\t\t\tlevel = level[key];\r\n\t\t}\r\n\r\n\t\tlevel[lastKey] = value;\r\n\t},\r\n\r\n\tgetDigitalStatus: function(values) {\r\n\t\tconst filled = this.getFilledCount(values);\r\n\t\tconst total = this.getBasketCount();\r\n\t\tlet result;\r\n\r\n\t\tif (filled >= total) {\r\n\t\t\tresult = 'READY';\r\n\t\t} else {\r\n\t\t\tresult = 'WAIT';\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetFilledCount: function(values) {\r\n\t\tlet result = 0;\r\n\r\n\t\tif (values['ITEM'] == null || !Array.isArray(values['ITEM'])) { return result; }\r\n\r\n\t\tfor (const item of values['ITEM']) {\r\n\t\t\tif (item['CODE'] !== '' && item['ACTIVATE_TILL'] !== '') {\r\n\t\t\t\t++result;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetBasketCount: function() {\r\n\t\treturn (this._basketCount != null ? this._basketCount : this.options.count);\r\n\t},\r\n\r\n\tsetBasketCount: function(count) {\r\n\t\tthis._basketCount = count;\r\n\t},\r\n\r\n\tgetFieldPlugin: function() {\r\n\t\treturn BasketItemDigital;\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemDigitalSummary',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemDigitalSummary',\r\n});\r\n\r\nexport const BasketItemDigitalSummary = constructor;","const BX = window.BX;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tinputElement: '.js-yamarket-basket-confirm-form__input',\r\n\t\tproductsElement: '.js-yamarket-basket-confirm-form__products',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_CONFIRM_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tallowRemove: function(allow) {\r\n\t\tconst input = this.getInput('ALLOW_REMOVE');\r\n\r\n\t\tinput.val(allow ? 'Y' : '');\r\n\t},\r\n\r\n\tsetItemsChanges: function(changes) {\r\n\t\tconst element = this.getElement('products');\r\n\t\tconst text = this.compileItemsChanges(changes);\r\n\r\n\t\telement.html(text);\r\n\t},\r\n\r\n\tcompileItemsChanges: function(changes) {\r\n\t\tconst rows = [];\r\n\r\n\t\tfor (const change of changes) {\r\n\t\t\trows.push(this.getLang('ITEM_CHANGE', {\r\n\t\t\t\tNAME: change.name,\r\n\t\t\t\tCOUNT: change.diff,\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\treturn rows.join('<hr />');\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketConfirmForm',\r\n\tpluginName: 'YandexMarket.OrderView.BasketConfirmForm',\r\n});\r\n\r\nexport const BasketConfirmForm = constructor;","import { BasketConfirmForm } from \"./basketconfirmform\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Summary.extend({\r\n\r\n\tdefaults: {\r\n\t\tmodalElement: '.js-yamarket-basket-confirm-summary__modal',\r\n\t\tfieldElement: '.js-yamarket-basket-confirm-summary__field',\r\n\r\n\t\tmodalWidth: 500,\r\n\t\tmodalHeight: 350,\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_CONFIRM_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._confirmDeferred = null;\r\n\t},\r\n\r\n\tonEditModalSave: function() {\r\n\t\tthis.callParent('onEditModalSave', constructor);\r\n\t\tthis.allowRemove(true);\r\n\t\tthis.resolveConfirm();\r\n\t},\r\n\r\n\tonEditModalClose: function() {\r\n\t\tthis.callParent('onEditModalClose', constructor);\r\n\t\tthis.allowRemove(false);\r\n\t\tthis.rejectConfirm();\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\t// nothing\r\n\t},\r\n\r\n\tconfirm: function(boxCollection) {\r\n\t\tconst changes = boxCollection.getCountChanges();\r\n\r\n\t\tif (changes.length === 0) {\r\n\t\t\tthis.allowRemove(false);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.setItemsChanges(changes);\r\n\t\tthis.initEdit();\r\n\r\n\t\treturn this.waitConfirm();\r\n\t},\r\n\r\n\tallowRemove: function(allow) {\r\n\t\tthis.callField('allowRemove', [allow]);\r\n\t},\r\n\r\n\tsetItemsChanges: function(changes) {\r\n\t\tthis.callField('setItemsChanges', [changes]);\r\n\t},\r\n\r\n\twaitConfirm: function() {\r\n\t\tthis._confirmDeferred = new $.Deferred();\r\n\r\n\t\treturn this._confirmDeferred;\r\n\t},\r\n\r\n\tresolveConfirm: function() {\r\n\t\tconst deferred = this._confirmDeferred;\r\n\r\n\t\tif (deferred === null) { return; }\r\n\r\n\t\tthis._confirmDeferred = null;\r\n\t\tdeferred.resolve();\r\n\t},\r\n\r\n\trejectConfirm: function() {\r\n\t\tconst deferred = this._confirmDeferred;\r\n\r\n\t\tif (deferred === null) { return; }\r\n\r\n\t\tthis._confirmDeferred = null;\r\n\t\tdeferred.reject();\r\n\t},\r\n\r\n\tgetFieldPlugin: function() {\r\n\t\treturn BasketConfirmForm;\r\n\t},\r\n\r\n\tgetLang: function(key, replaces) {\r\n\t\tif (key === 'MODAL_TITLE' && this.callField('getInput', ['REASON']) != null) {\r\n\t\t\tkey = 'MODAL_TITLE_WITH_REASON';\r\n\t\t}\r\n\r\n\t\treturn this.callParent('getLang', [key, replaces], constructor);\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketConfirmSummary',\r\n\tpluginName: 'YandexMarket.OrderView.BasketConfirmSummary',\r\n});\r\n\r\nexport const BasketConfirmSummary = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst YandexMarket = BX.namespace('YandexMarket');\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\n\r\nconst constructor = Plugin.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\turl: null,\r\n\t\twidth: 400,\r\n\t\theight: 300,\r\n\t\titems: [],\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('initialize', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleClick(true);\r\n\t\tthis.handleShipmentSubmit(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleClick(false);\r\n\t\tthis.handleShipmentSubmit(false);\r\n\t},\r\n\r\n\thandleClick: function(dir) {\r\n\t\tthis.$el[dir ? 'on' : 'off']('click', $.proxy(this.onClick, this));\r\n\t},\r\n\r\n\thandleShipmentSubmit: function(dir) {\r\n\t\tif (!dir || this.isDisabled()) {\r\n\t\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketShipmentSubmitEnd', BX.proxy(this.onShipmentSubmitEnd, this));\r\n\t\t}\r\n\t},\r\n\r\n\tonShipmentSubmitEnd: function(status) {\r\n\t\tif (status === 'ok') {\r\n\t\t\tthis.enable();\r\n\t\t\tthis.handleShipmentSubmit(false);\r\n\t\t}\r\n\t},\r\n\r\n\tonClick: function() {\r\n\t\tthis.createDropdown();\r\n\t\tthis.handleClick(false);\r\n\t},\r\n\r\n\tisDisabled: function() {\r\n\t\treturn this.$el.hasClass('is--hidden');\r\n\t},\r\n\r\n\tenable: function() {\r\n\t\tthis.$el.removeClass('is--hidden');\r\n\t},\r\n\r\n\tcreateDropdown: function() {\r\n\t\tconst items = this.getDropdownItems();\r\n\r\n\t\tBX.adminShowMenu(this.el, items);\r\n\t},\r\n\r\n\tgetDropdownItems: function() {\r\n\t\tconst result = [];\r\n\t\tconst items = this.options.items;\r\n\t\tlet itemIndex;\r\n\t\tlet item;\r\n\r\n\t\tfor (itemIndex = 0; itemIndex < items.length; itemIndex++) {\r\n\t\t\titem = items[itemIndex];\r\n\r\n\t\t\tresult.push({\r\n\t\t\t\tTEXT: item.TITLE,\r\n\t\t\t\tACTION: this.openDialog.bind(this, item.TYPE),\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\topenDialog: function(type) {\r\n\t\tconst item = this.getItem(type);\r\n\t\tconst url = this.buildUrl(item);\r\n\t\tconst dialog = this.createDialog(url, item);\r\n\r\n\t\tdialog.Show();\r\n\t},\r\n\r\n\tcreateDialog: function(url, item) {\r\n\t\treturn new YandexMarket.PrintDialog({\r\n\t\t\ttitle: item.DIALOG_TITLE || item.TITLE,\r\n\t\t\tcontent_url: url,\r\n\t\t\twidth: item.WIDTH || this.options.width,\r\n\t\t\theight: item.HEIGHT || this.options.height,\r\n\t\t\tbuttons: [\r\n\t\t\t\tYandexMarket.PrintDialog.btnSave,\r\n\t\t\t\tYandexMarket.PrintDialog.btnCancel\r\n\t\t\t]\r\n\t\t});\r\n\t},\r\n\r\n\tbuildUrl: function(item) {\r\n\t\tlet result = this.options.url;\r\n\r\n\t\tresult +=\r\n\t\t\t(result.indexOf('?') === -1 ? '?' : '&')\r\n\t\t\t+ 'type=' + item.TYPE;\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetItem: function(type) {\r\n\t\tconst items = this.options.items;\r\n\t\tlet result;\r\n\t\tlet itemIndex;\r\n\t\tlet item;\r\n\r\n\t\tfor (itemIndex = 0; itemIndex < items.length; itemIndex++) {\r\n\t\t\titem = items[itemIndex];\r\n\r\n\t\t\tif (item.TYPE === type) {\r\n\t\t\t\tresult = item;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewShipmentPrint',\r\n\tpluginName: 'YandexMarket.OrderView.ShipmentPrint',\r\n});\r\n\r\nexport const ShipmentPrint = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\nconst utils = BX.namespace('YandexMarket.Utils');\r\n\r\nconst constructor = Plugin.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\turl: 'yamarket_trading_shipment_submit.php',\r\n\r\n\t\tmessageElement: '.js-yamarket-shipment-submit__message',\r\n\t\tmessageRowTemplate: '<div class=\"yamarket-shipment-submit__result-row\" data-status=\"#STATUS#\">#TEXT#</div>',\r\n\r\n\t\torderElement: '.js-yamarket-order',\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_SHIPMENT_SUBMIT_'\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._handleBoxCollectionChange = false;\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('initialize', constructor);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleShipmentChange(false);\r\n\t\tthis.handleBoxCollectionChange(false);\r\n\t},\r\n\r\n\thandleShipmentChange: function(dir) {\r\n\t\tconst orderElement = this.getOrderElement();\r\n\r\n\t\torderElement[dir ? 'on' : 'off']('change', $.proxy(this.onOrderChange, this));\r\n\t},\r\n\r\n\thandleBoxCollectionChange: function(dir) {\r\n\t\tif (this._handleBoxCollectionChange === dir) { return; }\r\n\r\n\t\tthis._handleBoxCollectionChange = dir;\r\n\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxCollectionAddItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxCollectionDeleteItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxItemCollectionAddItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxItemCollectionDeleteItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t},\r\n\r\n\tonOrderChange: function() {\r\n\t\tthis.handleShipmentChange(false);\r\n\t\tthis.handleBoxCollectionChange(false);\r\n\t\tthis.clear();\r\n\t},\r\n\r\n\tonBoxCollectionModify: function(instance) {\r\n\t\tconst orderElement = this.getOrderElement();\r\n\r\n\t\tif ($.contains(orderElement[0], instance.el)) {\r\n\t\t\tthis.handleShipmentChange(false);\r\n\t\t\tthis.handleBoxCollectionChange(false);\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t},\r\n\r\n\tclear: function() {\r\n\t\tthis.showMessage('', '');\r\n\t},\r\n\r\n\tactivate: function() {\r\n\t\tif (this.el.disabled) { return; }\r\n\t\tif (!this.validate()) { return; }\r\n\r\n\t\t$.when(this.confirm())\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.el.disabled = true;\r\n\r\n\t\t\t\tthis.clear();\r\n\t\t\t\tthis.query().then(\r\n\t\t\t\t\t$.proxy(this.activateEnd, this),\r\n\t\t\t\t\t$.proxy(this.activateStop, this)\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t},\r\n\r\n\tactivateStop: function(xhr, reason) {\r\n\t\tconst message = this.getLang('FAIL', { 'REASON': reason });\r\n\r\n\t\tthis.el.disabled = false;\r\n\t\tthis.showMessage(message, 'error');\r\n\r\n\t\tthis.handleShipmentChange(true);\r\n\t\tthis.handleBoxCollectionChange(true);\r\n\t},\r\n\r\n\tactivateEnd: function(data) {\r\n\t\tlet status;\r\n\r\n\t\tthis.el.disabled = false;\r\n\r\n\t\tif (typeof data !== 'object' || data.status == null) {\r\n\t\t\tstatus = 'error';\r\n\t\t\tthis.showMessage(this.getLang('DATA_INVALID'), 'error');\r\n\t\t} else {\r\n\t\t\tstatus = data.status;\r\n\r\n\t\t\tif (data.messages != null) {\r\n\t\t\t\tthis.showMessages(data.messages);\r\n\t\t\t} else {\r\n\t\t\t\tthis.showMessage(data.message, status);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (status === 'ok') {\r\n\t\t\tthis.commit();\r\n\t\t}\r\n\r\n\t\tthis.handleShipmentChange(true);\r\n\t\tthis.handleBoxCollectionChange(true);\r\n\r\n\t\tBX.onCustomEvent(this.el, 'yamarketShipmentSubmitEnd', [status]);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tlet result = true;\r\n\t\tlet confirmMessage;\r\n\r\n\t\ttry {\r\n\t\t\tthis.getOrder().validate();\r\n\t\t} catch (e) {\r\n\t\t\tconfirmMessage = this.getLang('VALIDATION_CONFIRM', { MESSAGE: e.message });\r\n\t\t\tresult = confirm(confirmMessage || e.message);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tconfirm: function() {\r\n\t\treturn this.getOrder().confirm();\r\n\t},\r\n\r\n\tcommit: function() {\r\n\t\tthis.getOrder().commit();\r\n\t},\r\n\r\n\tquery: function() {\r\n\t\treturn $.ajax({\r\n\t\t\turl: this.options.url,\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: this.getQueryData(),\r\n\t\t\tdataType: 'json'\r\n\t\t});\r\n\t},\r\n\r\n\tgetQueryData: function() {\r\n\t\tconst data = this.getFormData();\r\n\r\n\t\tdata.push({\r\n\t\t\tname: 'sessid',\r\n\t\t\tvalue: BX.bitrix_sessid()\r\n\t\t});\r\n\r\n\t\treturn data;\r\n\t},\r\n\r\n\tshowMessages: function(messages) {\r\n\t\tconst element = this.getElement('message', this.$el, 'siblings');\r\n\t\tconst rowTemplate = this.getTemplate('messageRow');\r\n\t\tlet html = '';\r\n\r\n\t\tfor (let message of messages) {\r\n\t\t\thtml += utils.compileTemplate(rowTemplate, {\r\n\t\t\t\t'TEXT': message.text,\r\n\t\t\t\t'STATUS': message.status\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\telement.attr('data-status', '');\r\n\t\telement.html(html);\r\n\t},\r\n\r\n\tshowMessage: function(message, status) {\r\n\t\tconst element = this.getElement('message', this.$el, 'siblings');\r\n\r\n\t\telement.attr('data-status', status);\r\n\t\telement.html(message || '');\r\n\t},\r\n\r\n\tgetFormData: function() {\r\n\t\treturn this.getOrderElement().find('input, select, textarea').serializeArray();\r\n\t},\r\n\r\n\tgetOrderElement: function() {\r\n\t\treturn this.getElement('order', this.$el, 'closest');\r\n\t},\r\n\r\n\tgetOrder: function() {\r\n\t\tconst node = this.getOrderElement();\r\n\r\n\t\treturn Plugin.manager.getInstance(node);\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewShipmentSubmit',\r\n\tpluginName: 'YandexMarket.OrderView.ShipmentSubmit',\r\n});\r\n\r\nexport const ShipmentSubmit = constructor;\r\n"],"names":["BX","window","$","jQuery","constructor","namespace","Complex","extend","defaults","childElement","inputElement","areaElement","refreshUrl","initialize","callParent","bind","destroy","unbind","handleActivityEnd","dir","this","el","proxy","onActivityEnd","refresh","getId","input","getInput","val","confirm","boxCollection","getChildField","basketConfirm","validate","callChildList","commit","hasChanges","boxIndex","callItemList","box","getBasket","ajax","url","options","then","updateArea","html","contents","newAreas","getElement","newMap","mapAreas","existsAreas","existsMap","type","hasOwnProperty","newArea","replaceWith","onCustomEvent","target","areas","result","index","length","area","eq","data","dataName","pluginName","Order","selfElement","titleElement","numberElement","deleteElement","langPrefix","lang","handleDeleteClick","onDeleteClick","evt","preventDefault","onlyForPart","getLang","getCollection","deleteItem","$el","basketItem","isPart","getTitle","title","text","replace","trim","setIndex","updateNumber","refreshDelete","enabled","prop","refreshNumber","getIndex","getParentField","key","context","method","keySelector","getElementSelector","selfSelector","nextUntil","Box","Reference","Plugin","Collection","itemElement","footerElement","getCountChanges","concat","getPreviousMovableBox","previous","item","getNextMovableBox","found","createNew","addItem","sameBasketItems","e","message","Error","source","isCopy","refreshBoxNumber","refreshBoxDelete","detachItem","itemSelector","footerSelector","siblings","join","add","cloneItem","sourceItem","clone","appendItem","next","nextAll","parent","manager","initializeContext","silent","transferBasket","getItemInstance","basket","getActiveItems","siblingBox","initializeItem","getOrder","getItemPlugin","BoxCollection","YandexMarket","Base","modalWidth","modalHeight","initVars","_modal","_openDeferred","handleModal","modal","handleModalSave","handleModalClose","onModalSave","onModalClose","resolve","destroyModal","Close","reject","open","SetContent","Show","afterOpen","Deferred","resolveValues","skipCreate","EditDialog","btnSave","btnCancel","modalContent","PARTS","CONTENT_DATA","BasketItemSkeletonModal","BasketItemMoveModal","count","countElement","boxElement","currentIndex","selectedIndex","content","renderCount","renderBox","select","boxes","getItemInstances","i","option","prependTo","find","resolvedBox","resolvedCount","selected","parseInt","getItem","BasketItemSplitModal","id","upElement","moreElement","downElement","splitElement","splitModalElement","moveModalElement","_moreDropdown","handleCountChange","handleUp","handleDown","handleMore","onCountChange","onUp","onDown","onMore","updateCisCount","getBox","moveStart","menu","moreDropdown","currentTarget","setItems","moreMenuItems","currentBox","selectedBox","getCount","newItem","move","recalculateOffset","refreshItemMove","resolved","moveCount","setCount","setInitialCount","getInitialCount","newBox","needClone","sameItems","insertItem","anchor","CMenu","ATTACH_MODE","SET_ID","CLOSE_ON_CLICK","values","getValue","moreMenuItemsForSplit","moreMenuItemsForDelete","push","ONCLICK","markDeleted","TEXT","cancelSplit","splitStart","deleted","toggleClass","parts","initialCount","countSiblings","first","part","previousBox","resetPart","setOffset","basketItems","isFinalPart","total","split","deletedCount","deletedInitialCount","removeSiblings","lastItem","productIndex","isSelf","setPart","sameItem","currentInput","totalInput","nameElement","removeClass","addClass","refreshMoveUp","canMoveUp","refreshMoveDown","canMoveDown","offset","getOffset","isValid","fields","getCis","getDigital","field","setBasketCount","refreshSummary","currentValue","totalValue","boxIndexInput","changed","name","getCountDiff","needDelete","countInput","initialInput","BasketItem","detach","appendTo","targetId","nextBox","hasPrevious","hasNext","hasFewItems","activeCount","diff","Basket","copyElement","rowElement","copy","handleCopyClick","onCopyClick","copyValues","getCopyValue","Object","assign","setValue","rows","row","BasketItemCis","Summary","summaryElement","fieldElement","modalElement","requiredTypes","handleSummaryClick","onSummaryClick","openEditModal","updateField","syncSameBasketItems","ourBasketItem","getBasketItem","fieldName","value","siblingBasketItem","siblingCis","valueList","getCisStatus","status","statusText","summary","attr","getFilledCount","types","itemFilled","getBasketCount","callField","getFieldPlugin","createModal","BasketItemCisSummary","BasketItemDigital","modalBaseHeight","modalOneHeight","_basketCount","resolveModalHeight","raw","parseValue","getDigitalStatus","keyChain","valueKeyChain","setValueByKeyChain","chain","lastKey","pop","level","nextKey","test","Array","isArray","BasketItemDigitalSummary","BasketConfirmForm","productsElement","allowRemove","allow","setItemsChanges","changes","element","compileItemsChanges","change","NAME","COUNT","_confirmDeferred","onEditModalSave","resolveConfirm","onEditModalClose","rejectConfirm","initEdit","waitConfirm","deferred","replaces","BasketConfirmSummary","width","height","items","handleClick","handleShipmentSubmit","onClick","isDisabled","onShipmentSubmitEnd","enable","createDropdown","hasClass","getDropdownItems","adminShowMenu","itemIndex","TITLE","ACTION","openDialog","TYPE","buildUrl","createDialog","PrintDialog","DIALOG_TITLE","content_url","WIDTH","HEIGHT","buttons","indexOf","ShipmentPrint","utils","messageElement","messageRowTemplate","orderElement","_handleBoxCollectionChange","handleShipmentChange","handleBoxCollectionChange","getOrderElement","onOrderChange","onBoxCollectionModify","clear","instance","contains","showMessage","activate","disabled","when","query","activateEnd","activateStop","xhr","reason","messages","showMessages","confirmMessage","MESSAGE","getQueryData","dataType","getFormData","bitrix_sessid","rowTemplate","getTemplate","compileTemplate","serializeArray","node","getInstance","ShipmentSubmit"],"mappings":"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"}